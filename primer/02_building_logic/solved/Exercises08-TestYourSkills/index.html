<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Lessons for the Materials Project Workshop"><link href=https://workshop.materialsproject.org/primer/02_building_logic/solved/Exercises08-TestYourSkills/ rel=canonical><link rel="shortcut icon" href=../../../../assets/images/favicon.png><meta name=generator content="mkdocs-1.1.2, mkdocs-material-5.5.0"><title>Exercises08 TestYourSkills - The Materials Project Workshop</title><link rel=stylesheet href=../../../../assets/stylesheets/main.b5d04df8.min.css><link href=https://fonts.gstatic.com rel=preconnect crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback"><style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style><link rel=stylesheet href=../../../../workshop.css><link rel=stylesheet href=../../../../css/ansi-colours.css><link rel=stylesheet href=../../../../css/jupyter-cells.css><link rel=stylesheet href=../../../../css/pandas-dataframe.css></head> <body dir=ltr> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#lesson-8-test-your-skills class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class=md-header data-md-component=header> <nav class="md-header-nav md-grid" aria-label=Header> <a href=https://workshop.materialsproject.org title="The Materials Project Workshop" class="md-header-nav__button md-logo" aria-label="The Materials Project Workshop"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 2l-5 4.5v11l5-4.5V2M6.5 5C4.55 5 2.45 5.4 1 6.5v14.66c0 .25.25.5.5.5.1 0 .15-.07.25-.07 1.35-.65 3.3-1.09 4.75-1.09 1.95 0 4.05.4 5.5 1.5 1.35-.85 3.8-1.5 5.5-1.5 1.65 0 3.35.31 4.75 1.06.1.05.15.03.25.03.25 0 .5-.25.5-.5V6.5c-.6-.45-1.25-.75-2-1V19c-1.1-.35-2.3-.5-3.5-.5-1.7 0-4.15.65-5.5 1.5V6.5C10.55 5.4 8.45 5 6.5 5z"/></svg> </a> <label class="md-header-nav__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg> </label> <div class=md-header-nav__title data-md-component=header-title> <div class=md-header-nav__ellipsis> <span class="md-header-nav__topic md-ellipsis"> The Materials Project Workshop </span> <span class="md-header-nav__topic md-ellipsis"> Exercises08 TestYourSkills </span> </div> </div> <label class="md-header-nav__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query data-md-state=active> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </label> <button type=reset class="md-search__icon md-icon" aria-label=Clear data-md-component=search-reset tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg> </button> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list></ol> </div> </div> </div> </div> </div> <div class=md-header-nav__source> <a href=https://github.com/materialsproject/workshop/ title="Go to repository" class=md-source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg> </div> <div class=md-source__repository> GitHub </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=https://workshop.materialsproject.org title="The Materials Project Workshop" class="md-nav__button md-logo" aria-label="The Materials Project Workshop"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 2l-5 4.5v11l5-4.5V2M6.5 5C4.55 5 2.45 5.4 1 6.5v14.66c0 .25.25.5.5.5.1 0 .15-.07.25-.07 1.35-.65 3.3-1.09 4.75-1.09 1.95 0 4.05.4 5.5 1.5 1.35-.85 3.8-1.5 5.5-1.5 1.65 0 3.35.31 4.75 1.06.1.05.15.03.25.03.25 0 .5-.25.5-.5V6.5c-.6-.45-1.25-.75-2-1V19c-1.1-.35-2.3-.5-3.5-.5-1.7 0-4.15.65-5.5 1.5V6.5C10.55 5.4 8.45 5 6.5 5z"/></svg> </a> The Materials Project Workshop </label> <div class=md-nav__source> <a href=https://github.com/materialsproject/workshop/ title="Go to repository" class=md-source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg> </div> <div class=md-source__repository> GitHub </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../.. title=Home class=md-nav__link> Home </a> </li> <li class=md-nav__item> <a href=../../../../logistics/logistics/ title=Logistics class=md-nav__link> Logistics </a> </li> <li class=md-nav__item> <a href=../../../../people/people/ title=People class=md-nav__link> People </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-4 type=checkbox id=nav-4> <label class=md-nav__link for=nav-4> Primer <span class="md-nav__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg> </span> </label> <nav class=md-nav aria-label=Primer data-md-level=1> <label class=md-nav__title for=nav-4> <span class="md-nav__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </span> Primer </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../01_basic_python/0%20-%20Introduction%20and%20Jupyter%20Use/ title=Intro class=md-nav__link> Intro </a> </li> <li class=md-nav__item> <a href=../../../01_basic_python/1%20-%20Python%20Primer/ title="Basic Python" class=md-nav__link> Basic Python </a> </li> <li class=md-nav__item> <a href=../../../03_MongoDB_part1/lessons/ title="Intro to MongoDB" class=md-nav__link> Intro to MongoDB </a> </li> <li class=md-nav__item> <a href=../../../04_MongoDB_part2/lesson/ title="Advanced MongoDB" class=md-nav__link> Advanced MongoDB </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </span> Table of contents </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=#now-its-time-to-put-your-skills-to-the-test class=md-nav__link> Now it's time to put your skills to the test! </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content> <article class="md-content__inner md-typeset"> <a href=https://github.com/materialsproject/workshop/edit/master/docs/primer/02_building_logic/solved/Exercises08-TestYourSkills.ipynb title="Edit this page" class="md-content__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg> </a> <script src=https://cdnjs.cloudflare.com/ajax/libs/require.js/2.1.10/require.min.js></script> <script src=https://cdnjs.cloudflare.com/ajax/libs/jquery/2.0.3/jquery.min.js></script> <script>
(function() {
  function addWidgetsRenderer() {
    var mimeElement = document.querySelector('script[type="application/vnd.jupyter.widget-view+json"]');
    var scriptElement = document.createElement('script');
    var widgetRendererSrc = 'https://unpkg.com/@jupyter-widgets/html-manager@*/dist/embed-amd.js';
    var widgetState;

    // Fallback for older version:
    try {
      widgetState = mimeElement && JSON.parse(mimeElement.innerHTML);

      if (widgetState && (widgetState.version_major < 2 || !widgetState.version_major)) {
        widgetRendererSrc = 'jupyter-js-widgets@*/dist/embed.js';
      }
    } catch(e) {}

    scriptElement.src = widgetRendererSrc;
    document.body.appendChild(scriptElement);
  }

  document.addEventListener('DOMContentLoaded', addWidgetsRenderer);
}());
</script> <div class="cell border-box-sizing text_cell rendered"> <p><div class=inner_cell markdown=1> <div class="text_cell_render border-box-sizing rendered_html" markdown=1></p> <h1 id=lesson-8-test-your-skills>Lesson 8: Test your Skills<a class=headerlink href=#lesson-8-test-your-skills title="Permanent link">&para;</a></h1> <p></div> </div></p> </div> <div class="cell border-box-sizing text_cell rendered"> <p><div class=inner_cell markdown=1> <div class="text_cell_render border-box-sizing rendered_html" markdown=1></p> <h2 id=now-its-time-to-put-your-skills-to-the-test>Now it's time to put your skills to the test!<a class=headerlink href=#now-its-time-to-put-your-skills-to-the-test title="Permanent link">&para;</a></h2> <ul> <li>Exercise: As a materials investigator, your team has just finished running calculations for a large number of crystal structures. Now, you want to analyze the dataset by writing <strong>functions</strong> that utilize logic (in the form of <strong>conditionals</strong>) to parse through the datasets in the forms of <strong>dictionaries</strong> and <strong>lists</strong>. </div> </div></li> </ul> </div> <div class="cell border-box-sizing text_cell rendered"> <p><div class=inner_cell markdown=1> <div class="text_cell_render border-box-sizing rendered_html" markdown=1> First, load the relevant datasets </div> </div></p> </div> <div class="cell border-box-sizing code_cell rendered"> <div class=input> <div class=highlight><pre><span></span><code><span class=kn>import</span> <span class=nn>os</span>
<span class=kn>from</span> <span class=nn>monty.serialization</span> <span class=kn>import</span> <span class=n>loadfn</span>

<span class=n>data_dir</span> <span class=o>=</span> <span class=s2>&quot;../data/&quot;</span>

<span class=c1># Our crystal structures, in addition to useful elemental information</span>
<span class=n>crystals</span> <span class=o>=</span> <span class=n>loadfn</span><span class=p>(</span><span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>data_dir</span><span class=p>,</span> <span class=s2>&quot;crystals.json&quot;</span><span class=p>))</span>
<span class=n>atomic_numbers</span> <span class=o>=</span> <span class=n>loadfn</span><span class=p>(</span><span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>data_dir</span><span class=p>,</span> <span class=s2>&quot;atomic_numbers.json&quot;</span><span class=p>))</span>
<span class=n>atomic_weights</span> <span class=o>=</span> <span class=n>loadfn</span><span class=p>(</span><span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>data_dir</span><span class=p>,</span> <span class=s2>&quot;atomic_weights.json&quot;</span><span class=p>))</span>

<span class=c1># Names of elements associated with an element symbol (e.g. {&quot;Al&quot;: &quot;Aluminium&quot;})</span>
<span class=n>element_names</span> <span class=o>=</span> <span class=n>loadfn</span><span class=p>(</span><span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>data_dir</span><span class=p>,</span> <span class=s2>&quot;element_names.json&quot;</span><span class=p>))</span>

<span class=c1># Elemental mass fraction of Earth&#39;s crust (source: https://en.wikipedia.org/wiki/Abundances_of_the_elements_(data_page))</span>
<span class=n>mass_frac_earth_crust</span> <span class=o>=</span> <span class=n>loadfn</span><span class=p>(</span><span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>data_dir</span><span class=p>,</span> <span class=s2>&quot;mass_frac_earth_crust.json&quot;</span><span class=p>))</span>

<span class=c1># Dictionary of elements, with those who discovered them </span>
<span class=c1># and the year they were discovered </span>
<span class=c1># (sources: https://en.wikipedia.org/wiki/Timeline_of_chemical_element_discoveries,</span>
<span class=c1>#  https://education.jlab.org/qa/discover_ele.html)</span>
<span class=n>discovery_dict</span> <span class=o>=</span> <span class=n>loadfn</span><span class=p>(</span><span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>data_dir</span><span class=p>,</span> <span class=s2>&quot;discoveries.json&quot;</span><span class=p>))</span>
</code></pre></div> </div> </div> <div class="cell border-box-sizing text_cell rendered"> <p><div class=inner_cell markdown=1> <div class="text_cell_render border-box-sizing rendered_html" markdown=1> We have the mapping from <code>symbol</code> <span><span class=MathJax_Preview>\rightarrow</span><script type=math/tex>\rightarrow</script></span> <code>name</code>, now let's obtain <code>name</code> <span><span class=MathJax_Preview>\rightarrow</span><script type=math/tex>\rightarrow</script></span> <code>symbol</code> (we'll need it later) </div> </div></p> </div> <div class="cell border-box-sizing code_cell rendered"> <div class=input> <div class=highlight><pre><span></span><code><span class=nb>print</span><span class=p>(</span><span class=n>element_names</span><span class=p>[</span><span class=s2>&quot;Ag&quot;</span><span class=p>])</span>

<span class=n>element_symbols</span> <span class=o>=</span> <span class=p>{</span><span class=n>v</span><span class=p>:</span> <span class=n>k</span> <span class=k>for</span> <span class=n>k</span><span class=p>,</span> <span class=n>v</span> <span class=ow>in</span> <span class=n>element_names</span><span class=o>.</span><span class=n>items</span><span class=p>()}</span>

<span class=nb>print</span><span class=p>(</span><span class=n>element_symbols</span><span class=p>[</span><span class=s2>&quot;Silver&quot;</span><span class=p>])</span>
</code></pre></div> </div> </div> <div class="cell border-box-sizing text_cell rendered"> <p><div class=inner_cell markdown=1> <div class="text_cell_render border-box-sizing rendered_html" markdown=1> Next, we'll choose the set of elements that we would like to start with. Each element has a unique story associated with it. We can explore these stories with the information from the element discovery timeline.</p> <p><strong>Our task:</strong> Build a function that takes a list of element symbols as input. In addition, if we want to add the elements associated with a particular materials discoverer, we can include some <em>regex</em> (or "regular expression") strings corresponding to the discoverers we would like to feature. </div> </div></p> </div> <div class="cell border-box-sizing code_cell rendered"> <div class=input> <div class=highlight><pre><span></span><code><span class=kn>from</span> <span class=nn>pymatgen.core</span> <span class=kn>import</span> <span class=n>Element</span><span class=p>,</span> <span class=n>Composition</span>
</code></pre></div> </div> </div> <div class="cell border-box-sizing code_cell rendered"> <div class=input> <div class=highlight><pre><span></span><code><span class=k>def</span> <span class=nf>my_element_discoverer</span><span class=p>(</span><span class=n>elements</span><span class=p>:</span><span class=nb>list</span><span class=o>=</span><span class=p>[],</span> <span class=n>discoverers</span><span class=p>:</span><span class=nb>list</span><span class=o>=</span><span class=p>[],</span> <span class=n>prior_to</span><span class=p>:</span><span class=nb>int</span><span class=o>=</span><span class=mi>2020</span><span class=p>):</span>

    <span class=c1># Start with elements provided by user </span>
    <span class=c1># (use copy() to not modify list passed to function)</span>
    <span class=n>all_elements</span> <span class=o>=</span> <span class=n>elements</span><span class=o>.</span><span class=n>copy</span><span class=p>()</span>

    <span class=c1># Loop through discoverers to find which elements they discovered</span>
    <span class=c1># and then add them to your list</span>
    <span class=k>for</span> <span class=n>discoverer</span> <span class=ow>in</span> <span class=n>discoverers</span><span class=p>:</span>
        <span class=k>for</span> <span class=n>element_name</span> <span class=ow>in</span> <span class=n>discovery_dict</span><span class=p>:</span>

            <span class=k>for</span> <span class=n>name</span> <span class=ow>in</span> <span class=n>discovery_dict</span><span class=p>[</span><span class=n>element_name</span><span class=p>][</span><span class=s1>&#39;discovered_by&#39;</span><span class=p>]:</span>
                <span class=k>if</span> <span class=n>discoverer</span> <span class=ow>in</span> <span class=n>name</span><span class=p>:</span>
                    <span class=n>elem</span> <span class=o>=</span> <span class=n>Element</span><span class=p>(</span><span class=n>element_symbols</span><span class=p>[</span><span class=n>element_name</span><span class=p>])</span>
                    <span class=n>all_elements</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>elem</span><span class=p>)</span>

    <span class=c1># Create a new list that will contain only the elements discovered </span>
    <span class=c1># before the year you provide</span>
    <span class=n>elements_pruned</span> <span class=o>=</span> <span class=p>[]</span>

    <span class=k>for</span> <span class=n>elem</span> <span class=ow>in</span> <span class=n>all_elements</span><span class=p>:</span>
        <span class=n>element_name</span> <span class=o>=</span> <span class=n>element_names</span><span class=p>[</span><span class=nb>str</span><span class=p>(</span><span class=n>elem</span><span class=p>)]</span>
        <span class=k>if</span> <span class=n>discovery_dict</span><span class=p>[</span><span class=n>element_name</span><span class=p>][</span><span class=s1>&#39;year&#39;</span><span class=p>]</span> <span class=o>!=</span> <span class=s1>&#39;?&#39;</span><span class=p>:</span>
            <span class=n>year_discovered</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=n>discovery_dict</span><span class=p>[</span><span class=n>element_name</span><span class=p>][</span><span class=s1>&#39;year&#39;</span><span class=p>])</span>
        <span class=k>else</span><span class=p>:</span>
            <span class=c1># Unknown discovery date (known since ancient times)  </span>
            <span class=n>year_discovered</span> <span class=o>=</span> <span class=o>-</span><span class=mi>2000</span>

        <span class=k>if</span> <span class=n>year_discovered</span> <span class=o>&lt;</span> <span class=n>prior_to</span><span class=p>:</span>
            <span class=n>elem</span> <span class=o>=</span> <span class=n>Element</span><span class=p>(</span><span class=n>elem</span><span class=p>)</span>
            <span class=n>elements_pruned</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>elem</span><span class=p>)</span>

    <span class=n>all_elements</span> <span class=o>=</span> <span class=n>elements_pruned</span>

    <span class=c1># Use set() to convert your list into a unique set</span>
    <span class=c1># then recast as a list()</span>
    <span class=n>all_elements</span> <span class=o>=</span> <span class=nb>list</span><span class=p>(</span><span class=nb>set</span><span class=p>(</span><span class=n>all_elements</span><span class=p>))</span>

    <span class=k>return</span> <span class=n>all_elements</span>
</code></pre></div> </div> </div> <div class="cell border-box-sizing text_cell rendered"> <p><div class=inner_cell markdown=1> <div class="text_cell_render border-box-sizing rendered_html" markdown=1> Let's test out our function! Say we want to use oxygen in addition to elements discovered by scientists with Curie in their name (Marie and Pierre), as well as elements discovered by scientists in Berkeley </div> </div></p> </div> <div class="cell border-box-sizing code_cell rendered"> <div class=input> <div class=highlight><pre><span></span><code><span class=n>my_elements</span> <span class=o>=</span> <span class=n>my_element_discoverer</span><span class=p>(</span><span class=n>elements</span><span class=o>=</span><span class=p>[</span><span class=s2>&quot;O&quot;</span><span class=p>],</span> 
                                    <span class=n>discoverers</span><span class=o>=</span><span class=p>[</span><span class=s2>&quot;Curie&quot;</span><span class=p>,</span> <span class=s2>&quot;Lawrence Berkeley&quot;</span><span class=p>],</span> 
                                    <span class=n>prior_to</span><span class=o>=</span><span class=mi>2020</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>my_elements</span><span class=p>)</span>
</code></pre></div> </div> </div> <div class="cell border-box-sizing text_cell rendered"> <p><div class=inner_cell markdown=1> <div class="text_cell_render border-box-sizing rendered_html" markdown=1> Can you spot which elements are missing?</p> <p>(Hint below) </div> </div></p> </div> <div class="cell border-box-sizing code_cell rendered"> <div class=input> <div class=highlight><pre><span></span><code><span class=c1># Discovered by scientists at UC Berkeley</span>
<span class=n>my_elements</span> <span class=o>=</span> <span class=n>my_element_discoverer</span><span class=p>(</span><span class=n>discoverers</span><span class=o>=</span><span class=p>[</span><span class=s2>&quot;Ghiorso&quot;</span><span class=p>],</span> 
                                    <span class=n>prior_to</span><span class=o>=</span><span class=mi>2020</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>my_elements</span><span class=p>)</span>
</code></pre></div> </div> </div> <div class="cell border-box-sizing text_cell rendered"> <p><div class=inner_cell markdown=1> <div class="text_cell_render border-box-sizing rendered_html" markdown=1> Platinum was found in gold alloys in present day Columbia dating as far back as 800 BC </div> </div></p> </div> <div class="cell border-box-sizing code_cell rendered"> <div class=input> <div class=highlight><pre><span></span><code><span class=n>my_elements</span> <span class=o>=</span> <span class=n>my_element_discoverer</span><span class=p>(</span><span class=n>elements</span><span class=o>=</span><span class=p>[</span><span class=s2>&quot;Ni&quot;</span><span class=p>],</span> 
                                    <span class=n>discoverers</span><span class=o>=</span><span class=p>[</span><span class=s2>&quot;Indigenous People of South America&quot;</span><span class=p>],</span> 
                                    <span class=n>prior_to</span><span class=o>=</span><span class=mi>1800</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>my_elements</span><span class=p>)</span>
</code></pre></div> </div> </div> <div class="cell border-box-sizing text_cell rendered"> <p><div class=inner_cell markdown=1> <div class="text_cell_render border-box-sizing rendered_html" markdown=1> Next, our goal is to find all of the crystals that contain the elements in our list.</p> <p>Once we obtain this list, it is often useful to sort these materials based on a particular metric, depending on which properties that we would like to assess. The two criteria we will use in this study are the molar mass and abundance:</p> <ul> <li>Molar mass = <span><span class=MathJax_Preview>\sum_{i=1}^N x_i n_i</span><script type=math/tex>\sum_{i=1}^N x_i n_i</script></span>, where <span><span class=MathJax_Preview>n_i</span><script type=math/tex>n_i</script></span> is the elemental molar mass, and <span><span class=MathJax_Preview>x_i</span><script type=math/tex>x_i</script></span> is the molar fraction</li> <li>Abundance metric = <span><span class=MathJax_Preview>\prod_{i=1}^N a_i^{y_i}</span><script type=math/tex>\prod_{i=1}^N a_i^{y_i}</script></span>, where <span><span class=MathJax_Preview>a_i</span><script type=math/tex>a_i</script></span> is the mass abundance of the element <span><span class=MathJax_Preview>i</span><script type=math/tex>i</script></span>, and <span><span class=MathJax_Preview>y_i</span><script type=math/tex>y_i</script></span> is the mass fraction in the material </div> </div></li> </ul> </div> <div class="cell border-box-sizing code_cell rendered"> <div class=input> <div class=highlight><pre><span></span><code><span class=kn>import</span> <span class=nn>numpy</span> <span class=k>as</span> <span class=nn>np</span>
</code></pre></div> </div> </div> <div class="cell border-box-sizing code_cell rendered"> <div class=input> <div class=highlight><pre><span></span><code><span class=k>def</span> <span class=nf>compute_molar_weight</span><span class=p>(</span><span class=n>crystal</span><span class=p>):</span>
    <span class=c1># Obtain atomic fractions of material</span>
    <span class=n>comp</span> <span class=o>=</span> <span class=n>Composition</span><span class=p>(</span><span class=n>crystal</span><span class=p>[</span><span class=s2>&quot;pretty_formula&quot;</span><span class=p>])</span>                                                                                          
    <span class=n>atomic_fractions</span> <span class=o>=</span> <span class=p>[</span><span class=n>comp</span><span class=o>.</span><span class=n>get_atomic_fraction</span><span class=p>(</span><span class=n>Element</span><span class=p>(</span><span class=n>elem</span><span class=p>))</span> <span class=k>for</span> <span class=n>elem</span> <span class=ow>in</span> <span class=n>crystal</span><span class=p>[</span><span class=s1>&#39;elements&#39;</span><span class=p>]]</span>

    <span class=c1># Obtain atomic weights of elements in material</span>
    <span class=n>weights</span> <span class=o>=</span> <span class=p>[</span><span class=n>atomic_weights</span><span class=p>[</span><span class=n>elem</span><span class=p>]</span> <span class=k>for</span> <span class=n>elem</span> <span class=ow>in</span> <span class=n>crystal</span><span class=p>[</span><span class=s1>&#39;elements&#39;</span><span class=p>]]</span>

    <span class=c1># Compute molar weight of material (weighted mean)</span>
    <span class=n>molar_weight</span> <span class=o>=</span> <span class=mf>0.0</span>
    <span class=k>for</span> <span class=n>elem</span><span class=p>,</span><span class=n>frac</span><span class=p>,</span><span class=n>weight</span> <span class=ow>in</span> <span class=nb>zip</span><span class=p>(</span><span class=n>crystal</span><span class=p>[</span><span class=s2>&quot;elements&quot;</span><span class=p>],</span> <span class=n>atomic_fractions</span><span class=p>,</span> <span class=n>weights</span><span class=p>):</span>
        <span class=n>molar_weight</span> <span class=o>+=</span> <span class=n>frac</span><span class=o>*</span><span class=n>weight</span>

    <span class=k>return</span> <span class=n>molar_weight</span>

<span class=k>def</span> <span class=nf>compute_abundance_metric</span><span class=p>(</span><span class=n>crystal</span><span class=p>):</span>
    <span class=c1># Obtain mass fractions of material</span>
    <span class=n>comp</span> <span class=o>=</span> <span class=n>Composition</span><span class=p>(</span><span class=n>crystal</span><span class=p>[</span><span class=s2>&quot;pretty_formula&quot;</span><span class=p>])</span>                                                                                          
    <span class=n>molar_weight</span> <span class=o>=</span> <span class=n>compute_molar_weight</span><span class=p>(</span><span class=n>crystal</span><span class=p>)</span>
    <span class=n>mass_fractions</span> <span class=o>=</span> <span class=p>[</span><span class=n>comp</span><span class=o>.</span><span class=n>get_atomic_fraction</span><span class=p>(</span><span class=n>Element</span><span class=p>(</span><span class=n>elem</span><span class=p>))</span><span class=o>*</span><span class=p>(</span><span class=n>atomic_weights</span><span class=p>[</span><span class=n>elem</span><span class=p>]</span><span class=o>/</span><span class=n>molar_weight</span><span class=p>)</span> 
                      <span class=k>for</span> <span class=n>elem</span> <span class=ow>in</span> <span class=n>crystal</span><span class=p>[</span><span class=s1>&#39;elements&#39;</span><span class=p>]]</span>

    <span class=c1># Obtain atomic abundances of elements in material</span>
    <span class=n>abundances</span> <span class=o>=</span> <span class=p>[</span><span class=n>mass_frac_earth_crust</span><span class=p>[</span><span class=n>elem</span><span class=p>]</span> <span class=k>for</span> <span class=n>elem</span> <span class=ow>in</span> <span class=n>crystal</span><span class=p>[</span><span class=s1>&#39;elements&#39;</span><span class=p>]]</span>

    <span class=c1># Compute abundance metric (geometric mean)</span>
    <span class=n>abundance_metric</span> <span class=o>=</span> <span class=mf>1.0</span>
    <span class=k>for</span> <span class=n>elem</span><span class=p>,</span><span class=n>frac</span><span class=p>,</span><span class=n>abundance</span> <span class=ow>in</span> <span class=nb>zip</span><span class=p>(</span><span class=n>crystal</span><span class=p>[</span><span class=s2>&quot;elements&quot;</span><span class=p>],</span> <span class=n>mass_fractions</span><span class=p>,</span> <span class=n>abundances</span><span class=p>):</span>
        <span class=n>abundance_metric</span> <span class=o>*=</span> <span class=p>(</span><span class=mi>100</span><span class=o>*</span><span class=n>abundance</span><span class=p>)</span><span class=o>**</span><span class=n>frac</span>

    <span class=k>return</span> <span class=n>abundance_metric</span>
</code></pre></div> </div> </div> <div class="cell border-box-sizing code_cell rendered"> <div class=input> <div class=highlight><pre><span></span><code><span class=n>crystal</span> <span class=o>=</span> <span class=n>crystals</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;Material:&quot;</span><span class=p>,</span> <span class=n>crystal</span><span class=p>[</span><span class=s2>&quot;pretty_formula&quot;</span><span class=p>])</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;Molar weight (g / mol / # atoms per formula unit) = &quot;</span><span class=p>,</span> <span class=n>compute_molar_weight</span><span class=p>(</span><span class=n>crystal</span><span class=p>))</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;Abundance metric (% kg/kg) = &quot;</span><span class=p>,</span> <span class=n>compute_abundance_metric</span><span class=p>(</span><span class=n>crystal</span><span class=p>))</span>
</code></pre></div> </div> </div> <div class="cell border-box-sizing text_cell rendered"> <p><div class=inner_cell markdown=1> <div class="text_cell_render border-box-sizing rendered_html" markdown=1> Now that we have our sorting metrics, let's find the materials in our dataset that contain the elements we have provided, and sort them based on the criteria above.</p> <p>A helpful relation: For finite sets <span><span class=MathJax_Preview>A</span><script type=math/tex>A</script></span> and <span><span class=MathJax_Preview>B</span><script type=math/tex>B</script></span>, <span><span class=MathJax_Preview>B \subseteq A</span><script type=math/tex>B \subseteq A</script></span> if and only if <span><span class=MathJax_Preview>B = A \cap B</span><script type=math/tex>B = A \cap B</script></span> </div> </div></p> </div> <div class="cell border-box-sizing code_cell rendered"> <div class=input> <div class=highlight><pre><span></span><code><span class=k>def</span> <span class=nf>get_crystals_from_elements</span><span class=p>(</span><span class=n>elements</span><span class=p>:</span><span class=nb>list</span><span class=p>,</span> <span class=n>crystals</span><span class=p>:</span><span class=nb>list</span><span class=p>,</span> <span class=n>sort_scheme</span><span class=p>:</span><span class=nb>int</span><span class=o>=</span><span class=mi>0</span><span class=p>):</span>

    <span class=n>crystals_matched</span> <span class=o>=</span> <span class=p>[]</span>
    <span class=k>for</span> <span class=n>crystal</span> <span class=ow>in</span> <span class=n>crystals</span><span class=p>:</span>

        <span class=n>crystal_elems</span> <span class=o>=</span> <span class=p>[</span><span class=n>Element</span><span class=p>(</span><span class=n>elem</span><span class=p>)</span> <span class=k>for</span> <span class=n>elem</span> <span class=ow>in</span> <span class=n>crystal</span><span class=p>[</span><span class=s1>&#39;elements&#39;</span><span class=p>]]</span>

        <span class=c1># We can check if the material contains the elements that we have provided </span>
        <span class=c1># (set B in A) by checking if B = intersection(A,B)</span>
        <span class=n>intersection</span> <span class=o>=</span> <span class=nb>set</span><span class=p>(</span><span class=n>elements</span><span class=p>)</span> <span class=o>&amp;</span> <span class=nb>set</span><span class=p>(</span><span class=n>crystal_elems</span><span class=p>)</span>
        <span class=k>if</span> <span class=nb>set</span><span class=p>(</span><span class=n>elements</span><span class=p>)</span> <span class=o>==</span> <span class=n>intersection</span><span class=p>:</span>
            <span class=n>crystals_matched</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>crystal</span><span class=p>)</span>

    <span class=k>if</span> <span class=n>sort_scheme</span> <span class=o>==</span> <span class=mi>0</span><span class=p>:</span>
        <span class=c1># Sort by molar weight</span>
        <span class=n>sort_key</span> <span class=o>=</span> <span class=s2>&quot;Molar weight (g / mol / # atoms per formula unit)&quot;</span>
        <span class=n>sortable_values</span> <span class=o>=</span> <span class=p>[</span><span class=n>compute_molar_weight</span><span class=p>(</span><span class=n>crystal</span><span class=p>)</span> <span class=k>for</span> <span class=n>crystal</span> <span class=ow>in</span> <span class=n>crystals_matched</span><span class=p>]</span>
    <span class=k>elif</span> <span class=n>sort_scheme</span> <span class=o>==</span> <span class=mi>1</span><span class=p>:</span>
        <span class=c1># Sort by abundance metric</span>
        <span class=n>sort_key</span> <span class=o>=</span> <span class=s2>&quot;Abundance metric (% kg/kg)&quot;</span>
        <span class=n>sortable_values</span> <span class=o>=</span> <span class=p>[</span><span class=n>compute_abundance_metric</span><span class=p>(</span><span class=n>crystal</span><span class=p>)</span> <span class=k>for</span> <span class=n>crystal</span> <span class=ow>in</span> <span class=n>crystals_matched</span><span class=p>]</span>
    <span class=k>else</span><span class=p>:</span>
        <span class=c1># Catch all case - no sorting provided</span>
        <span class=n>sortable_values</span> <span class=o>=</span> <span class=p>[]</span>
        <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;Warning: Invalid sort scheme!&quot;</span><span class=p>)</span>
        <span class=k>return</span> <span class=p>[],</span> <span class=p>[],</span> <span class=s2>&quot;&quot;</span>

    <span class=k>if</span> <span class=n>sortable_values</span><span class=p>:</span>
        <span class=c1>#print(sortable_values)</span>

        <span class=c1># Sort crystals based on sorting metric (reverse to descending order)</span>
        <span class=n>value_map</span> <span class=o>=</span> <span class=p>[{</span><span class=s2>&quot;value&quot;</span><span class=p>:</span><span class=n>v</span><span class=p>,</span> <span class=s2>&quot;crystal&quot;</span><span class=p>:</span><span class=n>c</span><span class=p>}</span> <span class=k>for</span> <span class=n>v</span><span class=p>,</span><span class=n>c</span> <span class=ow>in</span> <span class=nb>zip</span><span class=p>(</span><span class=n>sortable_values</span><span class=p>,</span> <span class=n>crystals_matched</span><span class=p>)]</span>
        <span class=n>value_map</span> <span class=o>=</span> <span class=nb>sorted</span><span class=p>(</span><span class=n>value_map</span><span class=p>,</span> <span class=n>key</span><span class=o>=</span><span class=k>lambda</span> <span class=n>x</span><span class=p>:</span> <span class=n>x</span><span class=p>[</span><span class=s2>&quot;value&quot;</span><span class=p>],</span> <span class=n>reverse</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>        
        <span class=c1>#sortable_values, crystals_matched = zip(*sorted(zip(sortable_values, crystals_matched), reverse=True))</span>

        <span class=c1># Extract desired values after sorting</span>
        <span class=n>sortable_values</span> <span class=o>=</span> <span class=p>[</span><span class=n>x</span><span class=p>[</span><span class=s1>&#39;value&#39;</span><span class=p>]</span> <span class=k>for</span> <span class=n>x</span> <span class=ow>in</span> <span class=n>value_map</span><span class=p>]</span>
        <span class=n>crystals_matched</span> <span class=o>=</span> <span class=p>[</span><span class=n>x</span><span class=p>[</span><span class=s1>&#39;crystal&#39;</span><span class=p>]</span> <span class=k>for</span> <span class=n>x</span> <span class=ow>in</span> <span class=n>value_map</span><span class=p>]</span>

        <span class=c1>#print(sortable_values)</span>

    <span class=k>return</span> <span class=n>crystals_matched</span><span class=p>,</span> <span class=n>sortable_values</span><span class=p>,</span> <span class=n>sort_key</span>
</code></pre></div> </div> </div> <div class="cell border-box-sizing text_cell rendered"> <p><div class=inner_cell markdown=1> <div class="text_cell_render border-box-sizing rendered_html" markdown=1> We've built our functions! Now let's test them to search the materials in our dataset </div> </div></p> </div> <div class="cell border-box-sizing code_cell rendered"> <div class=input> <div class=highlight><pre><span></span><code><span class=c1># The elements we would like to search our dataset</span>
<span class=n>elements</span> <span class=o>=</span> <span class=p>[</span><span class=n>Element</span><span class=p>(</span><span class=n>elem</span><span class=p>)</span> <span class=k>for</span> <span class=n>elem</span> <span class=ow>in</span> <span class=p>[</span><span class=s1>&#39;Ca&#39;</span><span class=p>,</span> <span class=s1>&#39;O&#39;</span><span class=p>]]</span>

<span class=c1># Testing our function</span>
<span class=n>crystals_matched</span><span class=p>,</span> <span class=n>sorted_values</span><span class=p>,</span> <span class=n>sort_key</span> <span class=o>=</span> <span class=n>get_crystals_from_elements</span><span class=p>(</span><span class=n>elements</span><span class=p>,</span> <span class=n>crystals</span><span class=p>,</span> 
                                                                       <span class=n>sort_scheme</span><span class=o>=</span><span class=mi>0</span><span class=p>)</span>

<span class=c1># The formulas of the crystals that we searched for</span>
<span class=n>formulas</span> <span class=o>=</span> <span class=p>[</span><span class=n>crystal</span><span class=p>[</span><span class=s1>&#39;pretty_formula&#39;</span><span class=p>]</span> <span class=k>for</span> <span class=n>crystal</span> <span class=ow>in</span> <span class=n>crystals_matched</span><span class=p>]</span>

<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;Number of crystals found: &quot;</span><span class=p>,</span> <span class=nb>len</span><span class=p>(</span><span class=n>crystals_matched</span><span class=p>))</span>
<span class=c1># print(formulas)</span>
</code></pre></div> </div> </div> <div class="cell border-box-sizing text_cell rendered"> <p><div class=inner_cell markdown=1> <div class="text_cell_render border-box-sizing rendered_html" markdown=1> For a large number of materials, we often gain the most information by perfoming an analysis of how the sorting criteria is distributed. In this case, we can create a histogram of the data using the <code>matplotlib</code> package. </div> </div></p> </div> <div class="cell border-box-sizing code_cell rendered"> <div class=input> <div class=highlight><pre><span></span><code><span class=kn>import</span> <span class=nn>matplotlib.pyplot</span> <span class=k>as</span> <span class=nn>plt</span>

<span class=n>number_of_bins</span> <span class=o>=</span> <span class=mi>20</span>
<span class=n>plt</span><span class=o>.</span><span class=n>hist</span><span class=p>(</span><span class=n>sorted_values</span><span class=p>,</span> <span class=n>number_of_bins</span><span class=p>)</span>
<span class=n>plt</span><span class=o>.</span><span class=n>ylabel</span><span class=p>(</span><span class=s1>&#39;Counts&#39;</span><span class=p>)</span>
<span class=n>plt</span><span class=o>.</span><span class=n>xlabel</span><span class=p>(</span><span class=n>sort_key</span><span class=p>)</span>
<span class=n>plt</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</code></pre></div> </div> </div> <div class="cell border-box-sizing code_cell rendered"> <div class=input> <div class=highlight><pre><span></span><code>
</code></pre></div> </div> </div> </article> </div> </div> </main> <footer class=md-footer> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-footer-copyright> <div class=md-footer-copyright__highlight> Built by The Materials Project </div> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> </div> </div> </footer> </div> <script src=../../../../assets/javascripts/vendor.92ffa368.min.js></script> <script src=../../../../assets/javascripts/bundle.5123e3d4.min.js></script><script id=__lang type=application/json>{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents"}</script> <script>
        app = initialize({
          base: "../../../..",
          features: [],
          search: Object.assign({
            worker: "../../../../assets/javascripts/worker/search.a68abb33.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script> </body> </html>